census = read.csv('census.csv')
census = read.csv('census.csv')
set.seed(2000)
 library(caTools)
spl = sample.split(census$over50k, SplitRatio = 0.6)
train = subset(census, spl == TRUE)
test = subset(census, spl == FALSE)
model1 = glm(over50k~. , data = train , family = 'binomial')
summary(model1)
predictTest = predict(model1, type = "response", newdata = test)
table(test$over50k, predictTest>0.5)
(9051+1888)/(9051+662+1190+1888)
table(test$over50k)
9713/(9713+3078)
library(ROCR)
ROCRpred = prediction(predictTest, test$over50k)
as.numeric(performance(ROCpred, "auc")@y.values)
as.numeric(performance(ROCRpred, "auc")@y.values)
library(rpart)
library(rpart.plot)
censustree = rpart( over50k ~ . , method="class", data = train)
prp(censustree)
 predictTest = predict(censustree, newdata = test, type = "class")
table(test$over50k, predictTest)
(9243+1596)/(9243+470+1482+1596)
predictTest = predict(censustree, newdata = test)
predictTest = predictTest[,2]
ROCRpred = prediction(predictTest, test$over50k)
as.numeric(performance(ROCRpred, "auc")@y.values)
set.seed(1)
trainSmall = train[sample(nrow(train), 2000), ]
censusrf = randomForest(over50k ~ . , data = trainSmall)
library(randomForest)
censusrf = randomForest(over50k ~ . , data = trainSmall)
predictTest = predict(censusrf, newdata=test)
table(test$over50k, predictTest)
(9614+1050)/nrow(test) 
vu = varUsed(MODEL, count=TRUE)
vu = varUsed(censusrf, count=TRUE)
vusorted = sort(vu, decreasing = FALSE, index.return = TRUE)
dotchart(vusorted$x, names(MODEL$forest$xlevels[vusorted$ix]))
dotchart(vusorted$x, names(censusrf$forest$xlevels[vusorted$ix]))
varImpPlot(censusrf)
cartGrid = expand.grid( .cp = seq(0.002,0.1,0.002))
library(caret)
set.seed(2)
fitControl = trainControl( method = "cv", number = 10 )
fitControl = trainControl( method = "cv", number = 10 )
train( over50k ~ . , data = train, method = "rpart", trControl = fitControl, tuneGrid = cartGrid )
model = rpart(over50k~., data=train, method="class", cp=0.002)
predictTest = predict(model, newdata=test, type="class")
table(test$over50k, predictTest)
(9178+1838)/(9178+535+1240+1838)
prp(model)
q()
