cd = read.csv('ClaimsData.csv')
str(cd)
table(cd$heart.failure)
table(cd$bucket2009)/nrow(cd)
library(caTools)
set.seed(88)
spl = sample.split(cd$bucket2009, SplitRatio = 0.6)
train = subset(cd, spl == TRUE)
test = subset(cd, spl == FALSE)
summary(train$age)
table(train$diabetes)
104672/nrow(train)
table(test$bucket2009,test$bucket2008)
(110138+10721+2774+1539+104)/nrow(test)
PenaltyMatrix = matrix(c(0,1,2,3,4,2,0,1,2,3,4,2,0,1,2,6,4,2,0,1,8,6,4,2,0),byrow=TRUE,nrow=5)
PenaltyMatrix
as.matrix(table(test$bucket2009,test$bucket2008))*PenaltyMatrix
sum(as.matrix(table(test$bucket2009,test$bucket2008))*PenaltyMatrix)/nrow(test)
110138/nrow(test)
table(ClaimsTest$bucket2009)
table(test$bucket2009)
library(rpart)
library(rpart.plot)
cdTree = rpart(bucket2009 ~ age + arthritis + alzheimers + cancer + copd + depression + diabetes + heart.failure + ihd + kidney + osteoporosis + stroke + bucket2008 + reimbursement2008, data = train, method = 'class', cp =0.00005
)
prp(cdTree)
pred = predict(cdTree, newdata = test , type = 'class')
table(test$bucket2009, pred)
114141+16102+118+201
130562/nrow(test)
as.matrix(table(test$bucket2009, pred)
)*PenaltyMatrix
sum(as.matrix(table(test$bucket2009, pred))*PenaltyMatrix)/nrow(test)
cdTree = rpart(bucket2009 ~ age + arthritis + alzheimers + cancer + copd + depression + diabetes + heart.failure + ihd + kidney + osteoporosis + stroke + bucket2008 + reimbursement2008, data = train, method = 'class', cp =0.00005, parms = list(PenaltyMatrix))
cdTree = rpart(bucket2009 ~ age + arthritis + alzheimers + cancer + copd + depression + diabetes + heart.failure + ihd + kidney + osteoporosis + stroke + bucket2008 + reimbursement2008, data = train, method = 'class', cp =0.00005, parms = list(loss=PenaltyMatrix))
pred = predict(cdTree, newdata = test , type = 'class')
table(test$bucket2009, pred)
94310+18942+4692+636+2
118582/nrow(test)
sum(as.matrix(table(test$bucket2009, pred))*PenaltyMatrix)/nrow(test)
q()
